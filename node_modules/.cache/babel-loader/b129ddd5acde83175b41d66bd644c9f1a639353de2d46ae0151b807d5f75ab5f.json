{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"form-container\"\n};\nconst _hoisted_2 = {\n  class: \"container\"\n};\nconst _hoisted_3 = {\n  class: \"mb-3\"\n};\nconst _hoisted_4 = {\n  class: \"mb-3\"\n};\nconst _hoisted_5 = [\"disabled\"];\nconst _hoisted_6 = {\n  key: 0\n};\nconst _hoisted_7 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[5] || (_cache[5] = _createElementVNode(\"h2\", {\n    class: \"mb-4\"\n  }, \"Inserisci i tuoi dati\", -1 /* HOISTED */)), _createElementVNode(\"form\", {\n    onSubmit: _cache[2] || (_cache[2] = _withModifiers((...args) => _ctx.onSubmit && _ctx.onSubmit(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_3, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", {\n    for: \"attribute\",\n    class: \"form-label\"\n  }, \"Nome Attributo\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    id: \"attribute\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.formData.attribute = $event),\n    type: \"text\",\n    class: \"form-control\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.formData.attribute]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", {\n    for: \"value\",\n    class: \"form-label\"\n  }, \"Valore\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    id: \"value\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.formData.value = $event),\n    type: \"text\",\n    class: \"form-control\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.formData.value]])]), _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary btn-save\",\n    disabled: _ctx.loading\n  }, [_ctx.loading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_6, \"Salvando...\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_7, \"Salva\"))], 8 /* PROPS */, _hoisted_5)], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onSubmit","_cache","_withModifiers","args","_ctx","_hoisted_3","for","id","$event","formData","attribute","type","required","_hoisted_4","value","disabled","loading","_hoisted_6","_hoisted_7","_hoisted_5"],"sources":["/Users/alessandromagnani/Desktop/Università/applicazioni-e-servizi-web/osteoarthritis-project/frontend/src/views/ProfilePage.vue"],"sourcesContent":["<template>\n  <div class=\"form-container\">\n    <div class=\"container\">\n      <h2 class=\"mb-4\">Inserisci i tuoi dati</h2>\n\n      <form @submit.prevent=\"onSubmit\">\n        <div class=\"mb-3\">\n          <label for=\"attribute\" class=\"form-label\">Nome Attributo</label>\n          <input\n            id=\"attribute\"\n            v-model=\"formData.attribute\"\n            type=\"text\"\n            class=\"form-control\"\n            required\n          />\n        </div>\n\n        <div class=\"mb-3\">\n          <label for=\"value\" class=\"form-label\">Valore</label>\n          <input\n            id=\"value\"\n            v-model=\"formData.value\"\n            type=\"text\"\n            class=\"form-control\"\n            required\n          />\n        </div>\n\n        <button\n          type=\"submit\"\n          class=\"btn btn-primary btn-save\"\n          :disabled=\"loading\"\n        >\n          <span v-if=\"loading\">Salvando...</span>\n          <span v-else>Salva</span>\n        </button>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"ProfilePage\",\n  data() {\n    return {\n      userData: {},\n      editingField: {},\n      editableValues: {},\n      displayFields: {\n        name: { label: \"Nome\" },\n        family_name: { label: \"Cognome\" },\n        username: { label: \"Username\" },\n        email: { label: \"Email\" },\n        birthdate: { label: \"Data di Nascita\" },\n        phone_number: { label: \"Telefono\" },\n        address: { label: \"Indirizzo\" },\n        cap_code: { label: \"CAP\" },\n        gender: { label: \"Genere\" },\n        tax_code: { label: \"Codice Fiscale\" },\n      },\n    };\n  },\n  mounted() {\n    this.loadUserData();\n  },\n  methods: {\n    loadUserData() {\n      const userData = JSON.parse(localStorage.getItem(\"userData\"));\n      const userId = userData?.userId;\n      if (!userId) {\n        console.error(\"ID utente non definito\");\n        return;\n      }\n\n      fetch(`http://localhost:5000/get_user/${userId}`)\n        .then((response) =>\n          response.ok\n            ? response.json()\n            : Promise.reject(\"Errore nel recupero dei dati utente\")\n        )\n        .then((data) => {\n          this.userData = data;\n          this.resetEditableValues();\n        })\n        .catch((error) => {\n          console.error(\"Errore:\", error);\n          alert(\n            \"Si è verificato un errore durante il caricamento dei dati utente.\"\n          );\n        });\n    },\n    resetEditableValues() {\n      Object.keys(this.displayFields).forEach((key) => {\n        this.editableValues[key] = this.userData[key];\n        this.editingField[key] = false;\n      });\n    },\n    startEditing(field) {\n      this.editingField[field] = true;\n    },\n    saveField(field) {\n      const newValue = this.editableValues[field];\n      if (newValue !== this.userData[field]) {\n        this.updateUserData(field, newValue);\n      }\n      this.editingField[field] = false;\n    },\n    updateUserData(field, value) {\n      const userData = JSON.parse(localStorage.getItem(\"userData\"));\n      const userId = userData?.userId;\n      if (!userId) {\n        alert(\"Si è verificato un errore, l'ID utente non è disponibile.\");\n        return;\n      }\n\n      fetch(\"http://localhost:5000/update_user\", {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ userId, [field]: value }),\n      })\n        .then((response) => {\n          if (!response.ok) throw new Error(\"Errore nel salvataggio dei dati\");\n          alert(\"Informazione aggiornata con successo!\");\n          this.loadUserData();\n        })\n        .catch((error) => {\n          console.error(\"Errore:\", error);\n          alert(\"Si è verificato un errore durante l'aggiornamento.\");\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.form-container {\n  background: #ffffff;\n  min-height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.container {\n  max-width: 400px;\n  padding: 40px;\n  border-radius: 15px;\n  background: #ffffff;\n  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);\n}\n\nh2 {\n  font-size: 18px;\n  margin-bottom: 30px;\n}\n\n.form-label {\n  font-size: 12px;\n}\n\n.form-control {\n  background: #f2f2f2;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  font-size: 12px;\n}\n\n.btn-save {\n  width: 100%;\n  margin-top: 10px;\n  padding: 0.4rem;\n  font-size: 13px;\n  cursor: pointer;\n}\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAgB;;EACpBA,KAAK,EAAC;AAAW;;EAIbA,KAAK,EAAC;AAAM;;EAWZA,KAAK,EAAC;AAAM;mBAjBzB;;EAAAC,GAAA;AAAA;;EAAAA,GAAA;AAAA;;uBACEC,mBAAA,CAqCM,OArCNC,UAqCM,GApCJC,mBAAA,CAmCM,OAnCNC,UAmCM,G,0BAlCJD,mBAAA,CAA2C;IAAvCJ,KAAK,EAAC;EAAM,GAAC,uBAAqB,sBAEtCI,mBAAA,CA+BO;IA/BAE,QAAM,EAAAC,MAAA,QAAAA,MAAA,MALnBC,cAAA,KAAAC,IAAA,KAK6BC,IAAA,CAAAJ,QAAA,IAAAI,IAAA,CAAAJ,QAAA,IAAAG,IAAA,CAAQ;MAC7BL,mBAAA,CASM,OATNO,UASM,G,0BARJP,mBAAA,CAAgE;IAAzDQ,GAAG,EAAC,WAAW;IAACZ,KAAK,EAAC;KAAa,gBAAc,sB,gBACxDI,mBAAA,CAME;IALAS,EAAE,EAAC,WAAW;IAT1B,uBAAAN,MAAA,QAAAA,MAAA,MAAAO,MAAA,IAUqBJ,IAAA,CAAAK,QAAQ,CAACC,SAAS,GAAAF,MAAA;IAC3BG,IAAI,EAAC,MAAM;IACXjB,KAAK,EAAC,cAAc;IACpBkB,QAAQ,EAAR;iDAHSR,IAAA,CAAAK,QAAQ,CAACC,SAAS,E,KAO/BZ,mBAAA,CASM,OATNe,UASM,G,0BARJf,mBAAA,CAAoD;IAA7CQ,GAAG,EAAC,OAAO;IAACZ,KAAK,EAAC;KAAa,QAAM,sB,gBAC5CI,mBAAA,CAME;IALAS,EAAE,EAAC,OAAO;IApBtB,uBAAAN,MAAA,QAAAA,MAAA,MAAAO,MAAA,IAqBqBJ,IAAA,CAAAK,QAAQ,CAACK,KAAK,GAAAN,MAAA;IACvBG,IAAI,EAAC,MAAM;IACXjB,KAAK,EAAC,cAAc;IACpBkB,QAAQ,EAAR;iDAHSR,IAAA,CAAAK,QAAQ,CAACK,KAAK,E,KAO3BhB,mBAAA,CAOS;IANPa,IAAI,EAAC,QAAQ;IACbjB,KAAK,EAAC,0BAA0B;IAC/BqB,QAAQ,EAAEX,IAAA,CAAAY;MAECZ,IAAA,CAAAY,OAAO,I,cAAnBpB,mBAAA,CAAuC,QAjCjDqB,UAAA,EAiC+B,aAAW,M,cAChCrB,mBAAA,CAAyB,QAlCnCsB,UAAA,EAkCuB,OAAK,G,iBAlC5BC,UAAA,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}